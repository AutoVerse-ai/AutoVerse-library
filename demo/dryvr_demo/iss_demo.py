from origin_agent_heat import iss_agent
from verse.scenario import Scenario, ScenarioConfig
from verse.plotter.plotter2D import *
from verse.sensor.example_sensor.craft_sensor import CraftSensor

import plotly.graph_objects as go
from enum import Enum, auto
import time

#starset
from verse.analysis import ReachabilityMethod
from verse.stars.starset import StarSet
import polytope as pc
from verse.sensor.base_sensor_stars import *

from new_files.star_diams import *

class CraftMode(Enum):
    Default = auto()

if __name__ == "__main__":
    input_code_name = './demo/dryvr_demo/iss_controller.py'
    #scenario = Scenario()
    scenario = Scenario()


    car =  iss_agent('test', file_name=input_code_name)
    #scenario.add_agent(car)

    #pre starset
    '''
    # modify mode list input
    scenario.set_init(
        [
            [[-0.0000013, -0.0000006,-0.0000005, -0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,-0.0001000,0,0.8,0.9,0], [0.0000013,0.0000006,0.0000005,  0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,0.0001000,.1,1,1,0]],
        ],
        [
            tuple([CraftMode.Default]),
        ]
    )
    '''

    initial_set_polytope = pc.box2poly([[-1.3e-06, 1.3e-06], [-6e-07, 6e-07], [-5e-07, 5e-07], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [0, 0.1], [0.8, 1], [0.9, 1], [0, 0]])

    car.set_initial(StarSet.from_polytope(initial_set_polytope),  tuple([CraftMode.Default]))
    scenario.config.reachability_method = ReachabilityMethod.STAR_SETS
    scenario.add_agent(car)

    scenario.set_sensor(BaseStarSensor())

    # traces = scenario.simulate(3.64, .01)
    # fig = go.Figure()
    # fig = simulation_anime(traces, None, fig, 1, 2, [
    #                        1, 2], 'lines', 'trace', sample_rate=1)
    # fig.show()


    start_time = time.time()

    traces = scenario.verify(20, 0.01)
    run_time = time.time() - start_time

    print({
        "tool": "verse",
        "benchmark": "SpaceStation",
        "setup": "ISS02",
        "result": "1",
        "time": run_time,
        "metric2": "n/a",
        "metric3": "n/a",
    })

    diams = time_step_diameter(traces, 20, .01)
    print(len(diams))
    print(sum(diams))
    print(diams[0])
    print(diams[-1])


    #pre starset
    '''
    fig = go.Figure()
    fig = reachtube_tree(traces, None, fig, 0, 3, [0, 3],
                         'lines', 'trace')
    fig.update_layout(
        xaxis_title="t", yaxis_title="y3"
    )
    fig.update_xaxes(
        range=[0,20])
    #fig.show()
    '''

    scenario = Scenario()

    car = iss_agent('test', file_name=input_code_name)
    #scenario.add_agent(car)

    #pre starset
    '''
    # modify mode list input
    scenario.set_init(
        [
            [[-0.0000013, -0.0000006, -0.0000017, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000, -0.0001000,
              -0.0001000, 0, 0.8, 0.9, 0],
             [0.0000013, 0.0000006, 0.0000017, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000, 0.0001000,
              0.0001000, 0.0001000, 0.0001000, .1, 1, 1, 0]],
        ],
        [
            tuple([CraftMode.Default]),
        ]
    )
    '''

    # traces = scenario.simulate(3.64, .01)
    # fig = go.Figure()
    # fig = simulation_anime(traces, None, fig, 1, 2, [
    #                        1, 2], 'lines', 'trace', sample_rate=1)
    # fig.show()

    initial_set_polytope = pc.box2poly([[-1.3e-06, 1.3e-06], [-6e-07, 6e-07], [-1.7e-06, 1.7e-06], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [-0.0001, 0.0001], [0, 0.1], [0.8, 1], [0.9, 1], [0, 0]])

    car.set_initial(StarSet.from_polytope(initial_set_polytope),  tuple([CraftMode.Default]))
    scenario.config.reachability_method = ReachabilityMethod.STAR_SETS
    scenario.add_agent(car)

    scenario.set_sensor(BaseStarSensor())

    start_time = time.time()

    traces = scenario.verify(20, 0.01)
    run_time = time.time() - start_time

    print({
        "tool": "verse",
        "benchmark": "SpaceStation",
        "setup": "ISSU02",
        "result": "1",
        "time": run_time,
        "metric2": "n/a",
        "metric3": "n/a",
    })

    diams = time_step_diameter(traces, 20, .01)
    print(len(diams))
    print(sum(diams))
    print(diams[0])
    print(diams[-1])

    
    #pre starset
    '''
    fig = go.Figure()
    fig = reachtube_tree(traces, None, fig, 0, 3, [0, 3],
                         'lines', 'trace')
    fig.update_layout(
        xaxis_title="t", yaxis_title="y3"
    )
    '''

    #fig.show()

